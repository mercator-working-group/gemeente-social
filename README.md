# gemeente-social
An analysis of social media presence on official municipal websites of the Netherlands

## Overview
`gemeente-social` is a repository for investigative and analystical work specific to the prevalence of social media resources appearing on official websites belonging to municipalities in the Netherlands. This repository contains parameters used in this investigation and analyses perfomred to provide aggregate and annecdotal reporting on the useage of third-party commuinication and social platforms by govenmental municipal parties.

## Table of Contents: 
  - analysis
    - notebooks
        * Contains investigative methodology of OpenWPM result set and graphical exploration
    - derived_datasets
        * Saved output from analysis relevant to journalistic work packages
  - seed_list
      * Contains csv files with base site lists for OpenWPM crawls

## Dependencies
The instrumentation of the crawl used to collect data fro municipal websites for the gemeente-social project accomplished using a [custom fork](https://github.com/mercator-working-group/OpenWPM) of the [OpenWPM](https://github.com/mozilla/OpenWPM) web privacy measurement framework, developed by Steven Engelhardt at [Princeton univesity](https://webtap.princeton.edu/), currently hosted and maintained by [Mozilla](mozilla.org). 

## Workflow: region agnostic examination of private communication infrastructure by governmental entities

  - Accept an arbitrary seed list of government websites
  - Determine one-depth a-tag linkage structure with a shallow preliminary crawl
  - Perform a comprehensive crawl using OpenWPM to instrument JavaScript events at page visit
  - Parse OpenWPM data into Pandas table
  - Match against an arbitrary list
  - Indentify specific tracking pixels and potential fingerprinting attacks focussing on third-party loaded resources.
  - Generate a report of third-party resources and tracking activity occuring per page (from originally provided seed-list).

## Analyses
The primary analysis outputs were generated by the [cookie-discovery](https://github.com/mercator-working-group/gemeente-social/blob/master/analysis/notebooks/cookie-discovery.ipynb) notebook. 

  - Since the notebook loads data for all pages visisted (i.e. gementee landing pages, and all also all outbound links), the
    early cells reduce the dataset to only the parent pages themselves. 
      * *Note*: This means only the landing pages themselves are analyized, not outbound links or sub pages on the top level domain
  - The data from the OpenWPM javascript and site_visits tables  is then joined on visit_id, so that every javascript entry has it's
    corresponding site_visit details
  - There is a general overview of the javascript event data's content, structure and distribution inspecting
  - In cell [9] the dataset is reduced to only javascript events relating to _window.document.cookie_ activity
      * The result of which is a value count of the origin url of the javascript code executed for each _window.document.cookie_ entry
  - In cell [10] the popular domains that load javascript and interact with cookies are split up into get and set actions to roughly      gauge the overall dimensions of these actions
  - In cell [12] the dataset is filtered to javascript actions commited by code loaded from _facebook.net_ and presented
  - The remainder of the notebook investigates the common contents (keys/values) of cookies in the dataset presenting a potential 
    waypoint for further analysis 

The analysis undertaken in [cookie-discovery-full]() begins by analyzing the entire javascript dataset, that is the crawl results from all gementee landing pages as well as data from all outbound links. This is then reduced to a focused dataset described below:
  - In cell [14] the dataset is filtered by two criteria:
    1) Domains that had some javascript loaded from domains associated with social media:
      - `social_sites_js_analysis = js_analysis[ js_analysis['script_url_tld'].str.contains('|'.join(SM_FLDS), na=False) ]`
    2) Javascript events whose parent_url top level domain matches the site_visit url top level domain (this in effect means only pages   that exist on gementee domains)
      - `only_gementee_sub_pages = ss_js_analysis.loc[ss_js_analysis['site_url_tld'] == ss_js_analysis['parent_url_tld']]`


# FAQ

### When was the data used in this analysis collected?
The most recent full pre-crawl and comprehensive (OpenWPM) crawls were executed on May 29th, 2019 (UTC+2)
The crawl visited every site site listed here [gemeente-out-full.json](https://github.com/mercator-working-group/gemeente-social/blob/50572fac8deb02e55f129cd732a479f899f61432/gemeente-out-full.json) - it is structured so that the gemeente landing page, is the key of each entry, and the list of values are all href links on that page see [parse_utils.py](https://github.com/mercator-working-group/gemeente-social/blob/master/parse_utils.py)


